{% comment %}
  Preorder Announcement Snippet
  Shows on product pages when enabled in theme settings
  Checks if product has preorder date before displaying
{% endcomment %}

{% if settings.enable_preorder_announcement %}
  {% comment %} Check if product has preorder date {% endcomment %}
  {% assign has_preorder_date = false %}
  {% if product.metafields.custom.preorder_drop_date %}
    {% assign has_preorder_date = true %}
  {% endif %}

  {% if has_preorder_date %}
    <div class="preorder-announcement">
      <div class="preorder-announcement__container">
        
        {% comment %} Icon Row {% endcomment %}
        <div class="preorder-announcement__icons">
          
          {% comment %} Plant/Shopping Icon {% endcomment %}
          <div class="preorder-announcement__icon-wrapper">
            <div class="preorder-announcement__icon">
              <svg width="60" height="60" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Plant pot base -->
                <path d="M25 45h30l-3 20H28l-3-20z" fill="currentColor" opacity="0.9"/>
                <!-- Plant pot rim -->
                <rect x="22" y="42" width="36" height="6" rx="3" fill="currentColor"/>
                <!-- Shopping bag handle -->
                <path d="M35 42c0-5 0-10 5-10s5 5 5 10" stroke="currentColor" stroke-width="2" fill="none"/>
                <!-- Plant leaves -->
                <path d="M40 42c0-8-3-12-3-12s-3 4-3 12M40 42c0-8 3-12 3-12s3 4 3 12" stroke="currentColor" stroke-width="2" fill="none" opacity="0.7"/>
                <path d="M37 38c-2-4-5-6-5-6s-1 4 1 8M43 38c2-4 5-6 5-6s1 4-1 8" stroke="currentColor" stroke-width="2" fill="none" opacity="0.5"/>
              </svg>
            </div>
          </div>

          {% comment %} Devices with Plants Icon {% endcomment %}
          <div class="preorder-announcement__icon-wrapper">
            <div class="preorder-announcement__icon">
              <svg width="60" height="60" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Laptop -->
                <rect x="20" y="35" width="40" height="25" rx="2" fill="currentColor" opacity="0.9"/>
                <rect x="23" y="38" width="34" height="19" rx="1" fill="{{ settings.preorder_announce_icon_bg }}" opacity="0.8"/>
                <!-- Laptop keyboard -->
                <rect x="15" y="60" width="50" height="3" rx="1" fill="currentColor"/>
                
                <!-- Phone -->
                <rect x="50" y="28" width="20" height="30" rx="3" fill="currentColor" opacity="0.8"/>
                <rect x="52" y="31" width="16" height="22" rx="1" fill="{{ settings.preorder_announce_icon_bg }}" opacity="0.8"/>
                
                <!-- Plant on screen -->
                <circle cx="40" cy="47" r="3" fill="currentColor" opacity="0.6"/>
                <path d="M40 47c0-4-2-6-2-6s-2 2-2 6M40 47c0-4 2-6 2-6s2 2 2 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
                
                <!-- Small plant on phone -->
                <circle cx="60" cy="42" r="2" fill="currentColor" opacity="0.6"/>
                <path d="M60 42c0-2-1-3-1-3s-1 1-1 3" stroke="currentColor" stroke-width="1" fill="none"/>
              </svg>
            </div>
          </div>

          {% comment %} Location/Pickup Icon {% endcomment %}
          <div class="preorder-announcement__icon-wrapper">
            <div class="preorder-announcement__icon">
              <svg width="60" height="60" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Location pin -->
                <path d="M40 20c-8 0-15 7-15 15 0 10 15 25 15 25s15-15 15-25c0-8-7-15-15-15z" fill="currentColor" opacity="0.9"/>
                <!-- Inner circle -->
                <circle cx="40" cy="35" r="6" fill="{{ settings.preorder_announce_icon_bg }}" opacity="0.8"/>
                <!-- Plant inside pin -->
                <circle cx="40" cy="35" r="2" fill="currentColor"/>
                <path d="M40 35c0-3-1.5-4.5-1.5-4.5s-1.5 1.5-1.5 4.5M40 35c0-3 1.5-4.5 1.5-4.5s1.5 1.5 1.5 4.5" stroke="currentColor" stroke-width="1" fill="none"/>
              </svg>
            </div>
          </div>
        </div>

        {% comment %} Main Heading {% endcomment %}
        {% if settings.preorder_announce_heading != blank %}
          <h2 class="preorder-announcement__heading">{{ settings.preorder_announce_heading }}</h2>
        {% endif %}

        {% comment %} Action Text {% endcomment %}
        <div class="preorder-announcement__actions">
          {% if settings.preorder_announce_show_action_1 and settings.preorder_announce_action_1 != blank %}
            <span class="preorder-announcement__action">{{ settings.preorder_announce_action_1 }}</span>
          {% endif %}
          
          {% if settings.preorder_announce_show_action_2 and settings.preorder_announce_action_2 != blank %}
            {% if settings.preorder_announce_show_action_1 %}
              <span class="preorder-announcement__separator">{{ settings.preorder_announce_separator }}</span>
            {% endif %}
            <span class="preorder-announcement__action">{{ settings.preorder_announce_action_2 }}</span>
          {% endif %}
          
          {% if settings.preorder_announce_show_action_3 and settings.preorder_announce_action_3 != blank %}
            {% if settings.preorder_announce_show_action_1 or settings.preorder_announce_show_action_2 %}
              <span class="preorder-announcement__separator">{{ settings.preorder_announce_separator }}</span>
            {% endif %}
            <span class="preorder-announcement__action">{{ settings.preorder_announce_action_3 }}</span>
          {% endif %}
        </div>

      </div>
    </div>

    <style>
      .preorder-announcement {
        background-color: {{ settings.preorder_announce_bg }};
        color: {{ settings.preorder_announce_text }};
        padding: 60px 0;
        text-align: center;
        position: relative;
        overflow: hidden;
        margin: 60px 0;
      }

      .preorder-announcement::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 2px;
        background-color: {{ settings.preorder_announce_text }};
        opacity: 0.2;
        z-index: 1;
      }

      .preorder-announcement__container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        position: relative;
        z-index: 2;
      }

      .preorder-announcement__icons {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 50px;
        margin-bottom: 30px;
      }

      .preorder-announcement__icon-wrapper {
        background-color: {{ settings.preorder_announce_icon_bg }};
        border-radius: 50%;
        width: 100px;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .preorder-announcement__icon-wrapper:hover {
        transform: translateY(-2px);
      }

      .preorder-announcement__icon {
        color: {{ settings.preorder_announce_icon_color }};
      }

      .preorder-announcement__icon svg {
        width: 60px;
        height: 60px;
      }

      .preorder-announcement__heading {
        font-size: 48px;
        font-weight: 700;
        letter-spacing: 2px;
        margin: 0 0 20px;
        color: {{ settings.preorder_announce_text }};
        text-transform: uppercase;
      }

      .preorder-announcement__actions {
        font-size: 24px;
        font-weight: 500;
        letter-spacing: 3px;
        text-transform: uppercase;
      }

      .preorder-announcement__action {
        color: {{ settings.preorder_announce_text }};
      }

      .preorder-announcement__separator {
        margin: 0 20px;
        color: {{ settings.preorder_announce_text }};
      }

      @media (max-width: 768px) {
        .preorder-announcement {
          padding: 40px 0;
          margin: 40px 0;
        }

        .preorder-announcement__icons {
          gap: 20px;
          flex-wrap: wrap;
        }

        .preorder-announcement__icon-wrapper {
          width: 80px;
          height: 80px;
        }

        .preorder-announcement__icon svg {
          width: 50px;
          height: 50px;
        }

        .preorder-announcement__heading {
          font-size: 32px;
        }

        .preorder-announcement__actions {
          font-size: 18px;
        }

        .preorder-announcement__separator {
          margin: 0 10px;
        }
      }

      @media (max-width: 480px) {
        .preorder-announcement__heading {
          font-size: 24px;
        }

        .preorder-announcement__actions {
          font-size: 16px;
        }
      }
    </style>
  {% endif %}
{% endif %}